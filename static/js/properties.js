/**
 * AUTO-GENERATED PROPERTY CONFIG WITH CATEGORIES
 * ==============================================
 * ⚠️  DO NOT EDIT THIS FILE MANUALLY
 */

window.PROPERTY_DATA = {
    basePath: "/static/images/projects/",
    defaultLocation: "Calamba, Laguna, Philippines",
    categories: [
    {
        "id": "commercial-lot",
        "name": "Commercial Lot"
    },
    {
        "id": "commercial-space",
        "name": "Commercial Space"
    },
    {
        "id": "house-and-lot",
        "name": "House And Lot"
    },
    {
        "id": "house-only",
        "name": "House Only"
    },
    {
        "id": "lot-only",
        "name": "Lot Only"
    }
],
    projectsByCategory: {
        "commercial-lot": {
                "8": {
                        "name": "8",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-lot",
                        "folder": "8",
                        "images": [
                                "image_106.jpeg"
                        ]
                }
        },
        "commercial-space": {
                "7": {
                        "name": "7",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-space",
                        "folder": "7",
                        "images": [
                                "Image_104.jpeg"
                        ]
                },
                "9": {
                        "name": "9",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-space",
                        "folder": "9",
                        "images": [
                                "Image_108.jpeg"
                        ]
                },
                "10": {
                        "name": "10",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-space",
                        "folder": "10",
                        "images": [
                                "Screenshot 2024-07-16 at 4.11.39 AM.png",
                                "image_111.jpeg",
                                "image_112.jpeg"
                        ]
                },
                "11": {
                        "name": "11",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-space",
                        "folder": "11",
                        "images": [
                                "image_115.jpeg",
                                "image_116.jpeg",
                                "image_117.jpeg",
                                "image_118.jpeg"
                        ]
                },
                "12": {
                        "name": "12",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "commercial-space",
                        "folder": "12",
                        "images": [
                                "image_120.jpeg",
                                "image_121.jpeg",
                                "image_122.jpeg",
                                "image_123.jpeg"
                        ]
                }
        },
        "house-and-lot": {
                "2": {
                        "name": "2",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-and-lot",
                        "folder": "2",
                        "images": [
                                "image_89.jpeg",
                                "image_90.jpeg"
                        ]
                },
                "5": {
                        "name": "5",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-and-lot",
                        "folder": "5",
                        "images": [
                                "a.jpeg"
                        ]
                },
                "6": {
                        "name": "6",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-and-lot",
                        "folder": "6",
                        "images": [
                                "image_102.jpeg"
                        ]
                },
                "13": {
                        "name": "13",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-and-lot",
                        "folder": "13",
                        "images": []
                },
                "Turn over Unit (Model House)": {
                        "name": "Turn over Unit (Model House)",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-and-lot",
                        "folder": "Turn over Unit (Model House)",
                        "images": [
                                "image_131.jpeg",
                                "image_135.jpeg",
                                "image_136.jpeg",
                                "image_137.jpeg",
                                "image_138.jpeg",
                                "image_142.jpeg",
                                "image_143.jpeg"
                        ]
                }
        },
        "house-only": {
                "1": {
                        "name": "1",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-only",
                        "folder": "1",
                        "images": [
                                "image_83.jpeg",
                                "image_84.jpeg",
                                "image_86.jpeg",
                                "image_87.jpeg",
                                "other.jpeg"
                        ]
                },
                "3": {
                        "name": "3",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-only",
                        "folder": "3",
                        "images": [
                                "image_92.jpeg"
                        ]
                },
                "4": {
                        "name": "4",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-only",
                        "folder": "4",
                        "images": [
                                "image_94.jpeg",
                                "image_95.jpeg",
                                "image_97.jpeg",
                                "image_98.jpeg"
                        ]
                },
                "14": {
                        "name": "14",
                        "location": "Calamba, Laguna, Philippines",
                        "category": "house-only",
                        "folder": "14",
                        "images": [
                                "image_127.jpeg"
                        ]
                }
        },
        "lot-only": {}
},

    /**
     * Get property with full image paths and additional features
     */
    async getProperty(category, id) {
        const project = this.projectsByCategory[category]?.[id];
        if (!project) return null;

        const images = project.images.map(filename => 
            this.basePath + category + "/" + project.folder + "/" + filename
        );

        // Default values
        let description = null;
        let location = project.location || this.defaultLocation; // Use default if not set
        let status = null;               // e.g., "CLEAN CCT COMPLETE"
        let price = null;                // e.g., "₱5,500,000.00"
        let contact = [];                // optional contact info array
        let other = null;                // optional notes

        // Base features for all properties
        let features = [
            { icon: "fas fa-home", text: "Residential Property" },        // type of property
            { icon: "fas fa-map-marker-alt", text: location },            // location
            { icon: "fas fa-tag", text: this.getCategoryName(category) }, // category
            { icon: "fas fa-images", text: images.length + " Photo" + (images.length !== 1 ? "s" : "") } // images count
        ];

        // Load property.json if exists
        try {
            const response = await fetch(`${this.basePath}${category}/${project.folder}/property.json`);
            if (response.ok) {
                const jsonData = await response.json();

                // Override location if specified, otherwise use default
                if (jsonData.location) {
                    location = jsonData.location;
                } else {
                    location = this.defaultLocation;
                }
                
                const locIndex = features.findIndex(f => f.icon === "fas fa-map-marker-alt");
                if (locIndex >= 0) features[locIndex].text = location;

                // Override status, price, contact, other
                if (jsonData.status) status = jsonData.status;
                if (jsonData.price) price = jsonData.price;
                if (jsonData.contact) contact = jsonData.contact;
                if (jsonData.other) other = jsonData.other;

                // Override description if provided
                if (jsonData.description) description = jsonData.description;

                // Add extra features from property.json
                if (Array.isArray(jsonData.features)) {
                    features = features.concat(
                        jsonData.features.map(f => ({
                            icon: f.icon || "fas fa-info-circle",
                            text: f.text
                        }))
                    );
                }

                // ✅ Automatically add status and price as features
                if (status) features.push({ icon: "fas fa-check-circle", text: status });
                if (price) features.push({ icon: "fas fa-money-bill-wave", text: price });

            } else {
                // fallback to description.txt if property.json is missing
                const resp = await fetch(`${this.basePath}${category}/${project.folder}/description.txt`);
                if (resp.ok) description = await resp.text();
            }
        } catch (err) {
            try {
                const resp = await fetch(`${this.basePath}${category}/${project.folder}/description.txt`);
                if (resp.ok) description = await resp.text();
            } catch {}
        }

        // Return the full property object
        return {
            id,
            category,
            categoryName: this.getCategoryName(category),
            name: project.name,
            location,
            status,
            price,
            contact,
            other,
            folder: project.folder,
            images,
            description,
            features
        };
    },

    async getPropertiesByCategory(category) {
        const projects = this.projectsByCategory[category] || {};
        const all = {};
        for (let id in projects) {
            all[id] = await this.getProperty(category, id);
        }
        return all;
    },

    async getAllProperties() {
        const all = {};
        for (let category in this.projectsByCategory) {
            all[category] = await this.getPropertiesByCategory(category);
        }
        return all;
    },

    getCategoryName(categoryId) {
        const category = this.categories.find(cat => cat.id === categoryId);
        return category ? category.name : categoryId;
    },

    getTotalProjects() {
        let count = 0;
        for (let category in this.projectsByCategory) {
            count += Object.keys(this.projectsByCategory[category]).length;
        }
        return count;
    }
};

// Backwards compatibility
window.PROPERTY_CONFIG = window.PROPERTY_DATA;
window.PROPERTY_LOADER = window.PROPERTY_DATA;
