/**
 * PARTNERS DATA GENERATOR
 * =======================
 * Run this script to auto-generate partners.js from your images folder
 * 
 * Usage: node generate-partners.js
 */

const fs = require('fs');
const path = require('path');

const PARTNERS_DIR = './static/images/partners';
const OUTPUT_FILE = './static/js/partners.js';

/**
 * Scan all images in partners directory
 */
function scanPartners() {
    // Check if directory exists
    if (!fs.existsSync(PARTNERS_DIR)) {
        console.error(`âŒ Directory not found: ${PARTNERS_DIR}`);
        console.log('ğŸ’¡ Make sure you run this from the root of your project');
        process.exit(1);
    }
    
    const files = fs.readdirSync(PARTNERS_DIR);
    
    // Get all image files
    const images = files.filter(file => 
        /\.(jpg|jpeg|png|gif|webp)$/i.test(file)
    ).sort(); // Sort alphabetically
    
    console.log(`ğŸ“ Found ${images.length} partner images\n`);
    
    // Generate partner objects - filename (without extension) as title
    const partners = images.map(filename => {
        // Use filename without extension as title
        const title = filename.replace(/\.(jpg|jpeg|png|gif|webp)$/i, '');
        
        console.log(`âœ“ ${filename} â†’ "${title}"`);
        
        return {
            filename: filename,
            title: title
        };
    });
    
    return partners;
}

/**
 * Generate the partners.js file
 */
function generateFile() {
    console.log('ğŸ”¨ Generating partners.js...\n');
    
    const partners = scanPartners();
    
    const fileContent = `/**
 * AUTO-GENERATED PARTNERS CONFIG
 * ==============================
 * âš ï¸  DO NOT EDIT THIS FILE MANUALLY
 * 
 * Generated: ${new Date().toISOString()}
 * Generator: generate-partners.js
 * 
 * To regenerate: Run 'node generate-partners.js'
 * 
 * WARNING: Manual edits will be overwritten!
 */

window.PARTNERS_DATA = {
    basePath: "/static/images/partners/",
    
    partners: ${JSON.stringify(partners, null, 8)}
};

/**
 * =============================================
 * HOW TO ADD NEW PARTNERS
 * =============================================
 * 
 * Step 1: Add images to folder
 * -----------------------------
 * /static/images/partners/
 *   â”œâ”€â”€ amaia-land.jpeg
 *   â”œâ”€â”€ crown-asia.png
 *   â””â”€â”€ partner-name.jpg
 * 
 * The filename (without extension) becomes the title:
 *   amaia-land.jpeg â†’ Title: "amaia-land"
 *   crown-asia.png â†’ Title: "crown-asia"
 * 
 * Step 2: Run the generator
 * -------------------------
 * node generate-partners.js
 * 
 * Step 3: Upload & Done!
 * ----------------------
 * Git will commit the updated partners.js
 * 
 * =============================================
 */
`;
    
    // Ensure output directory exists
    const outputDir = path.dirname(OUTPUT_FILE);
    if (!fs.existsSync(outputDir)) {
        fs.mkdirSync(outputDir, { recursive: true });
    }
    
    fs.writeFileSync(OUTPUT_FILE, fileContent);
    
    console.log(`\nâœ… Generated ${OUTPUT_FILE}`);
    console.log(`ğŸ“¦ Total partners: ${partners.length}`);
    console.log(`\nğŸš€ Ready to commit and push!`);
}

// Run the generator
try {
    generateFile();
} catch (error) {
    console.error('âŒ Error:', error.message);
    process.exit(1);
}
